# Git Under The Hood

## Git Object Types
Blob = A single file in Git, files with extensions such as .txt files, .mp3 files
Tree = Information about directories (Contains a set of blobs or set of blobs and trees)
Commit = Stores different versions of our projects
Annotated tag = Persitent text pointers to specific commits

## Git low-level commands
`git hash-object` - Create a new *git object* and write it into a git repository
`git cat-file` - Read information about the git object
`git mktree` - Create a new *tree object* in git

`echo "Hello, Git" | git hash-object --stdin -w` - Pass the string "Hello, Git" into git hash-object by piping it through. This creates a unique hash specific for the strings "Hello, Git", 'Hello, Git', Hello, Git. The -w option saves the git hash-object in folder **.git/objects/b7** (b7 = first two characters in hash string. Folder name + File name = Hash). Since folders are created based on the first two hash numbers, unrelated git objects can be stored in the same folder if they start with the same two hash numbers.

> Git database is a set of key-value pairs like the above paragraph suggests, similar to JSON. Those are generated by using one-way hash functions.

## Hash functions
Git uses a SHA1 hash.

1. Hash functions are one-way, meaning that you cannot get the input value by knowing the hash.
2. The same input will always give the same hash.

## Hexadecimal format
Hexadecimal format has 16 characters: 0 1 2 3 4 5 6 7 8 9 A B C D E F

Base 10 format: 0 1 2 3 4 5 6 7 8 9

Base 2 format (binary): 0 1

> Four binary digits (also called nibbles) make up half a byte. This means one byte can carry binary values from 0000 0000 to 1111 1111. In hex, these can be represented in a friendlier fashion, ranging from 00 to FF.

## Convert from hexadecimal to binary
Converting from hex to binary is straightforward since hexadecimal numbers are simplified versions of binary strings. You just need to remember that each hex value will produce four binary digits.

**Step 1:** Write down the hex number. If there are any, change the hex values represented by letters to their decimal equivalents.  

**Step 2:** Each hex digit represents four binary digits and therefore is equal to a power of 2. The rightmost digit equals to 20 (1), the next one equals to 21 (2), the next one equals to 22 (4) and the leftmost one equals to 23 (8). Write these numbers (8, 4, 2 and 1) below the hex values.  

**Step 3:** Determine which powers of two (8, 4, 2 or 1) sum up to your hex digits. For example, if one of your hex values is 10, this means 8 and 2 sum up to 10 (4 and 1 are not used). If your hex number is 2, only 2 is used; 8, 4 and 1 are not.  

**Step 4:** Write down 1 below those 8, 4, 2 and 1’s that are used. Write down 0 below those that are not used.  

**Step 5:** Read the 1’s and 0’s from left to right to get the binary equivalent of the given hex number.


**Hexadecimal to binary table**  
| Decimal        | Hex           | Binary  |
| -------------- |:-------------:| -------:|
| 0              | 0             | 0       |
| 1              | 1             | 1       |
| 2              | 2             | 10      |
| 3              | 3             | 11      |
| 4              | 4             | 100     |
| 5              | 5             | 101     |
| 6              | 6             | 110     |
| 7              | 7             | 111     |
| 8              | 8             | 1000    |
| 9              | 9             | 1001    |
| 10             | A             | 1010    |
| 11             | B             | 1011    |
| 12             | C             | 1100    |
| 13             | D             | 1101    |
| 14             | E             | 1110    |
| 15             | F             | 1111    |
| 16             | 10            | 10000   |
| 30             | 1E            | 11110   |
| 31             | 1F            | 11111   |
| 32             | 20            | 100000  |

## Low level git commands basic workflow
`echo "New file in repo" > new_file.txt` - Create new file
`cat new_file.txt` - See new file content
`git hash-object new_file.txt -w` - Create new git object (ef612cd3359cadf7849edd014e318bae5d892a54)
`git cat-file -p ef612cd3359cadf7849edd014e318bae5d892a54` - See new git object content

## Git trees

### Git object permissions
Permissions are stored in git tree objects.

040000 Directory
100644 Regular non-executable file
100664 Regular non-executable group-writable file
100755 Regular executable file
120000 Symbolic link
160000 Gitlink

### Creating a Git tree 
`find ./../.git/objects -type f` - See the files of git object folder  
`nano temp-tree.txt` - Open nano editor and create a new file

**Enter the following lines in your temp-tree.txt file**  
100644 blob b7aec520dec0a7516c18eb4c68b64ae1eb9b5a5e	file1.txt  
100644 blob ef612cd3359cadf7849edd014e318bae5d892a54	file2.txt


#### Create the actual Git tree
`cat temp-tree.txt | git mktree` - Create a new Git tree based on the contents of temp-tree.txt
Hash for tree: c374b790aa7d77074bb0445679137a32704a610d

### Examine Git tree contents
`git cat-file -p c374b790aa7d77074bb0445679137a32704a610d` - Will give the same lines we pasted into temp-tree.txt except that it is now stored in a git tree
`git cat-file -t c374` - See the type of our newly created tree

## Working directory, Staging area and Git repository
There are 3 locations where files live in git: Working directory, Staging area (index) and Git repository.  

The staging area is responsible for storing files that are going to be put into the git repository or fetched from the git repository into the working directory.

At this stage, since we have put files directly into the git objects folder, those are stored in the git repository directly without using commits.

### Put files into staging area
`git read-tree c374b790aa7d77074bb0445679137a32704a610d` - Take files from git repository and put them into staging area

### Examine files in staging area
`git ls-files -s` - Check the staging area for files (YOU HAVE TO BE IN THE ROOT OF YOUR PROJECT SINCE WE MADE OR TREE REFERENCES THERE)

### Put files from the staging area into working directory
`git checkout-index -a` - Take all files in the staging are and put them into working directory (YOU HAVE TO BE IN THE ROOT OF YOUR PROJECT SINCE WE MADE OR TREE REFERENCES THERE)











